<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="David Rach">
<meta name="dcterms.date" content="2026-02-23">

<title>04 - Introduction to Tidyverse – Cytometry in R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../Schedule.html" rel="next">
<link href="../../course/03_InsideFCSFile/index.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-8eaec6b9941db0f18eecf13b95a46332.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-LZ35J3XE4D"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-LZ35J3XE4D', { 'anonymize_ip': true});
</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../images/hex.svg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Cytometry in R</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Schedule.html"> 
<span class="menu-text">Schedule</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../course/index.html"> 
<span class="menu-text">Course</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/UMGCCCFCSR/CytometryInR/discussions"> 
<span class="menu-text">Discussions</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.youtube.com/@CytometryInR"> <i class="bi bi-youtube" role="img" aria-label="YouTube">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/UMGCCCFCSR/CytometryInR"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../course/01_InstallingRPackages/index.html">Intro to R</a></li><li class="breadcrumb-item"><a href="../../course/04_IntroToTidyverse/index.html">04 - Intro to Tidyverse</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
  <div id="quarto-announcement" data-announcement-id="517fd7fd2923fd64fe81c4cc75c6fa55" class="alert alert-info hidden"><i class="bi bi-info-circle quarto-announcement-icon"></i><div class="quarto-announcement-content">
<p>See Course tab for Course Materials, see YouTube tab for livestream recordings</p>
</div><i class="bi bi-x-lg quarto-announcement-action"></i></div>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Getting Started</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course/00_GitHub/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00 - GitHub</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course/00_WorkstationSetup/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00 - Workstation Setup</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course/00_Positron/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00 - Positron</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course/00_Git/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00 - Git</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course/00_Quarto/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00 - Quarto</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course/00_Homeworks/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00 - Getting Help</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course/00_Floreada/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00 - Floreada</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../course/01_InstallingRPackages/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Intro to R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course/01_InstallingRPackages/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01 - Installing R Packages</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course/02_FilePaths/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02 - File Paths</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course/03_InsideFCSFile/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03 - Inside a .FCS file</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course/04_IntroToTidyverse/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">04 - Intro to Tidyverse</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Cytometry Core</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Beyond the Sandbox</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">The World is your Oyster</span></span>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#background" id="toc-background" class="nav-link active" data-scroll-target="#background">Background</a></li>
  <li><a href="#walk-through" id="toc-walk-through" class="nav-link" data-scroll-target="#walk-through">Walk Through</a>
  <ul>
  <li><a href="#read.csv" id="toc-read.csv" class="nav-link" data-scroll-target="#read.csv">read.csv</a></li>
  <li><a href="#data.frame" id="toc-data.frame" class="nav-link" data-scroll-target="#data.frame">data.frame</a></li>
  <li><a href="#column-value-type" id="toc-column-value-type" class="nav-link" data-scroll-target="#column-value-type">Column value type</a></li>
  <li><a href="#select-columns" id="toc-select-columns" class="nav-link" data-scroll-target="#select-columns">select (Columns)</a>
  <ul>
  <li><a href="#pipe-operators" id="toc-pipe-operators" class="nav-link" data-scroll-target="#pipe-operators">Pipe Operators</a></li>
  <li><a href="#r-quirks" id="toc-r-quirks" class="nav-link" data-scroll-target="#r-quirks">R Quirks</a></li>
  <li><a href="#selecting-multiple-columns" id="toc-selecting-multiple-columns" class="nav-link" data-scroll-target="#selecting-multiple-columns">Selecting multiple columns</a></li>
  </ul></li>
  <li><a href="#relocate" id="toc-relocate" class="nav-link" data-scroll-target="#relocate">relocate</a></li>
  <li><a href="#rename" id="toc-rename" class="nav-link" data-scroll-target="#rename">rename</a></li>
  <li><a href="#pull" id="toc-pull" class="nav-link" data-scroll-target="#pull">pull</a></li>
  <li><a href="#filter-rows" id="toc-filter-rows" class="nav-link" data-scroll-target="#filter-rows">filter (Rows)</a></li>
  <li><a href="#mutate" id="toc-mutate" class="nav-link" data-scroll-target="#mutate">mutate</a></li>
  <li><a href="#arrange" id="toc-arrange" class="nav-link" data-scroll-target="#arrange">arrange</a></li>
  </ul></li>
  <li><a href="#take-away" id="toc-take-away" class="nav-link" data-scroll-target="#take-away">Take Away</a></li>
  <li><a href="#additional-resources" id="toc-additional-resources" class="nav-link" data-scroll-target="#additional-resources">Additional Resources</a></li>
  <li><a href="#take-home-problems" id="toc-take-home-problems" class="nav-link" data-scroll-target="#take-home-problems">Take-home Problems</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../course/01_InstallingRPackages/index.html">Intro to R</a></li><li class="breadcrumb-item"><a href="../../course/04_IntroToTidyverse/index.html">04 - Intro to Tidyverse</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">04 - Introduction to Tidyverse</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>David Rach </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 23, 2026</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p><img src="../../images/WebsiteBanner.png" class="img-fluid"></p>
<div style="text-align: right;">
<p><a href="https://www.gnu.org/licenses/agpl-3.0.en.html"><img src="https://img.shields.io/badge/license-AGPLv3-blue.png" class="img-fluid" alt="AGPL-3.0"></a> <a href="http://creativecommons.org/licenses/by-sa/4.0/"><img src="https://img.shields.io/badge/License-CC%20BY--SA%204.0-lightgrey.svg" class="img-fluid" alt="CC BY-SA 4.0"></a></p>
</div>
<p>For the YouTube livestream schedule, see <a href="https://www.youtube.com/@cytometryinr">here</a></p>
<p>For screen-shot slides, click <a href="../../course/04_IntroToTidyverse/slides.html">here</a></p>
<section id="background" class="level1">
<h1>Background</h1>
<p>Within our daily workflows as cytometrist, after acquiring data on our respective instruments, we begin analyzing the resulting datasets. After implementing various workflows, we then export data for downstream statistical analysis.</p>
<p>When I first started my Ph.D program, a substantial amount of my day was spent renaming column names of the exported data so that they would fit nicely in a Microsoft Excel sheet column; setting up formulas to combine proportion of positive cells across positive quadrants, etc. Once this was done, additional hours would go by as I copied and pasted contents of those columns over to a GraphPad Prism worksheet for statistical analysis.</p>
<p>This of course was in an ideal scenario. Often times, the data was less organized, and instead of time spent copying and pasting over columns, it would first be spent rearranging values from individual cells in the worksheet that were separated by spaces, all the while trying to remember what various color codes and bold font stood for.</p>
<p>Today, we will explore what makes data <a href="https://vita.had.co.nz/papers/tidy-data.pdf">“tidy”</a>, and how to use the toolsets implemented in the various <a href="https://cran.r-project.org/web/packages/tidyverse/vignettes/paper.html">tidyverse</a> R packages. At it’s simplest, if we think of and organize all our data in terms of rows and columns, we need fewer tools (ie. functions) to reshape and extract useful information that we are interested in. Additionally, this approach aligns more closely with how computers work, allowing us to carry out tasks that would otherwise have taken hours in mere seconds.</p>
<p>The dataset we will be using today is a manually-gated spectral flow cytometry dataset (similar to ones we would see exported by commercial software), and has been intentionally left slightly messy. You could however just as easily use a “matrix” or “data.frame” object exported from inside an <a href="../../course/03_InsideFCSFile/">fcs file</a>, or swap in your own dataset. You would just need to make sure to switch out the input data by providing an alternate <a href="../../course/02_FilePaths/">file path</a>, etc.</p>
<hr>
</section>
<section id="walk-through" class="level1">
<h1>Walk Through</h1>
<div class="callout callout-style-default callout-important callout-titled" title="Housekeeping">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Housekeeping
</div>
</div>
<div class="callout-body-container callout-body">
<p>As we do <a href="../../course/02_FilePaths/index.html">every week</a>, on GitHub, sync your forked version of the CytometryInR course to bring in the most recent updates. Then within Positron, pull in those changes to your local computer.</p>
<p>After creating a “Week04” project folder, copy over the contents of “course/04_IntroToTidyverse” to that folder. This will hopefully prevent any merge issues when you attempt to bring in new data to your local Cytometry in R folder next week. Please remember once you have set up your project folder to stage, commit and pus your changes to “Week04” to GitHub so that they are backed up remotely.</p>
<p>If you are having issues syncing due to the Take-Home Problem merge conflict, see this <a href="https://umgcccfcsr.github.io/CytometryInR/course/00_BonusContent/PullConflicts/">walkthrough</a></p>
</div>
</div>
<hr>
<section id="read.csv" class="level2">
<h2 class="anchored" data-anchor-id="read.csv">read.csv</h2>
<p>We will start by first loading in our copied over dataset (Dataset.csv) from it’s location in the project folder. If you are following the organization scheme we have been using throughout the course, your file path will look something like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>thefilepath <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">"data"</span>, <span class="st">"Dataset.csv"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>thefilepath</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "data/Dataset.csv"</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Reminder">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Reminder
</div>
</div>
<div class="callout-body-container callout-body">
<p>We encourage using the <code>file.path</code> function to build our file paths, as this keeps our code reproducible and replicable when a project folder is copied to other people’s computers that differ on whether the operating system uses forward or backward slash separation between folders.</p>
</div>
</div>
<p>Above, we directly specified the name (Dataset) and filetype (.csv) of the file we wanted in the last argument of the file.path (“Dataset.csv”). This allows us to skip the <code>list.files()</code> step we used last week as we have provided the full file path. While this approach can be faster, if we accidentally mistype the file name, we could end up with an error at the next step due to no files being found with the mistyped name.</p>
<p>Since our dataset is stored as a .csv file, we will be using the <code>read.csv()</code> function from the <code>utils</code> package (included in our base R software installation) to read it into R. We will also use the <code>colnames()</code> function from last week to get a read-out of the column names.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file=</span>thefilepath, <span class="at">check.names=</span><span class="cn">FALSE</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "bid"               "timepoint"         "Condition"        
 [4] "Date"              "infant_sex"        "ptype"            
 [7] "root"              "singletsFSC"       "singletsSSC"      
[10] "singletsSSCB"      "CD45"              "NotMonocytes"     
[13] "nonDebris"         "lymphocytes"       "live"             
[16] "Dump+"             "Dump-"             "Tcells"           
[19] "Vd2+"              "Vd2-"              "Va7.2+"           
[22] "Va7.2-"            "CD4+"              "CD4-"             
[25] "CD8+"              "CD8-"              "Tcells_count"     
[28] "lymphocytes_count" "Monocytes"         "Debris"           
[31] "CD45_count"       </code></pre>
</div>
</div>
<p>As we look at the line of code, we now have enough context to decipher that the “file” argument is where we provide a file path to an individual file, but what does the “check.names” argument do?</p>
<p>Let’s see what happens to the column names when we set “check.names” argument to TRUE:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>Data_Alternative <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(thefilepath, <span class="at">check.names=</span><span class="cn">TRUE</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Data_Alternative)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "bid"               "timepoint"         "Condition"        
 [4] "Date"              "infant_sex"        "ptype"            
 [7] "root"              "singletsFSC"       "singletsSSC"      
[10] "singletsSSCB"      "CD45"              "NotMonocytes"     
[13] "nonDebris"         "lymphocytes"       "live"             
[16] "Dump."             "Dump..1"           "Tcells"           
[19] "Vd2."              "Vd2..1"            "Va7.2."           
[22] "Va7.2..1"          "CD4."              "CD4..1"           
[25] "CD8."              "CD8..1"            "Tcells_count"     
[28] "lymphocytes_count" "Monocytes"         "Debris"           
[31] "CD45_count"       </code></pre>
</div>
</div>
<p>As we can see, any column name that contained a special character or a space was automatically converted over to <a href="https://ssojet.com/escaping/regex-escaping-in-r#understanding-the-need-for-escaping-special-characters">R-approved syntax</a>. However, this resulted in the loss of both +” and “-”, leaving us unable to determine whether we are looking at cells within or outside a particular gate.</p>
<p><img src="images/00_CheckNamesTRUE.png" class="img-fluid"></p>
<p>Because of this, it is often better to rename columns individually after import, which we will learn how to do later today.</p>
<p>Following up with what we practiced last week, lets use the <code>head()</code> function to visualize the first few rows of data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Data, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      bid timepoint Condition       Date infant_sex  ptype    root singletsFSC
1 INF0052         0      Ctrl 2025-07-26       Male HEU-hi 2098368     1894070
2 INF0100         0      Ctrl 2025-07-26       Male HEU-lo 2020184     1791890
3 INF0100         4      Ctrl 2025-07-26       Male HEU-lo 1155040     1033320
  singletsSSC singletsSSCB      CD45 NotMonocytes nonDebris lymphocytes
1     1666179      1537396 0.5952943    0.8820349 0.8627649   0.6420138
2     1697083      1579098 0.9106762    0.9052256 0.8602660   0.2145848
3      875465       845446 0.9705765    0.9845400 0.9578793   0.7403110
       live      Dump+     Dump-    Tcells        Vd2+      Vd2-     Va7.2+
1 0.9020581 0.21090996 0.6911482 0.2804264 0.008120361 0.9918796 0.01448070
2 0.8908981 0.06252775 0.8283703 0.6748298 0.007265620 0.9927344 0.01577499
3 0.8757665 0.20023803 0.6755285 0.6119129 0.004651313 0.9953487 0.01579402
     Va7.2-      CD4+      CD4-      CD8+       CD8- Tcells_count
1 0.9773989 0.6341164 0.3432825 0.2734826 0.06979990       164771
2 0.9769594 0.6119112 0.3650482 0.3357696 0.02927858       208241
3 0.9795547 0.6639621 0.3155925 0.2862104 0.02938209       371723
  lymphocytes_count  Monocytes     Debris CD45_count
1            587573 0.11796509 0.13723513     915203
2            308583 0.09477437 0.13973396    1438047
3            607477 0.01545999 0.04212072     820570</code></pre>
</div>
</div>
<p>When working in Positron, we could have alternatively clicked on the little grid icon next to our created variable “Data” in the right secondary sidebar, which would have opened the data in our Editor window. From this same window, we can see it is stored as a “data.frame” object type.</p>
<p><img src="images/01_DataView.png" class="img-fluid"></p>
<p>We could also achieve the same window to open using the <code>View()</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(Data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wrapping up our brief recap of <a href="../../course/03_InsideFCSFile/index.html">last week</a> functions, we can check an objects type using both the <code>class()</code> and <code>str()</code> functions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(Data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "data.frame"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(Data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   196 obs. of  31 variables:
 $ bid              : chr  "INF0052" "INF0100" "INF0100" "INF0100" ...
 $ timepoint        : int  0 0 4 9 0 4 9 4 9 0 ...
 $ Condition        : chr  "Ctrl" "Ctrl" "Ctrl" "Ctrl" ...
 $ Date             : chr  "2025-07-26" "2025-07-26" "2025-07-26" "2025-07-26" ...
 $ infant_sex       : chr  "Male" "Male" "Male" "Male" ...
 $ ptype            : chr  "HEU-hi" "HEU-lo" "HEU-lo" "HEU-lo" ...
 $ root             : int  2098368 2020184 1155040 358624 1362216 1044808 1434840 972056 1521928 2363512 ...
 $ singletsFSC      : int  1894070 1791890 1033320 328624 1206309 917398 1265022 875707 1359574 2136616 ...
 $ singletsSSC      : int  1666179 1697083 875465 289327 1032946 735579 988445 767323 1175755 1875394 ...
 $ singletsSSCB     : int  1537396 1579098 845446 276289 982736 685592 940454 718000 1097478 1732620 ...
 $ CD45             : num  0.595 0.911 0.971 0.982 0.957 ...
 $ NotMonocytes     : num  0.882 0.905 0.985 0.986 0.956 ...
 $ nonDebris        : num  0.863 0.86 0.958 0.941 0.841 ...
 $ lymphocytes      : num  0.642 0.215 0.74 0.651 0.705 ...
 $ live             : num  0.902 0.891 0.876 0.915 0.895 ...
 $ Dump+            : num  0.2109 0.0625 0.2002 0.2147 0.3383 ...
 $ Dump-            : num  0.691 0.828 0.676 0.701 0.557 ...
 $ Tcells           : num  0.28 0.675 0.612 0.631 0.44 ...
 $ Vd2+             : num  0.00812 0.00727 0.00465 0.01135 0.00475 ...
 $ Vd2-             : num  0.992 0.993 0.995 0.989 0.995 ...
 $ Va7.2+           : num  0.0145 0.0158 0.0158 0.017 0.0133 ...
 $ Va7.2-           : num  0.977 0.977 0.98 0.972 0.982 ...
 $ CD4+             : num  0.634 0.612 0.664 0.438 0.739 ...
 $ CD4-             : num  0.343 0.365 0.316 0.534 0.243 ...
 $ CD8+             : num  0.273 0.336 0.286 0.486 0.195 ...
 $ CD8-             : num  0.0698 0.0293 0.0294 0.0476 0.0476 ...
 $ Tcells_count     : int  164771 208241 371723 111552 291777 271870 487937 220634 415867 184930 ...
 $ lymphocytes_count: int  587573 308583 607477 176662 663667 510730 726238 451047 710964 652155 ...
 $ Monocytes        : num  0.118 0.0948 0.0155 0.0145 0.0444 ...
 $ Debris           : num  0.1372 0.1397 0.0421 0.0587 0.1592 ...
 $ CD45_count       : int  915203 1438047 820570 271304 940733 675857 921660 701657 1066884 1017713 ...</code></pre>
</div>
</div>
</section>
<section id="data.frame" class="level2">
<h2 class="anchored" data-anchor-id="data.frame">data.frame</h2>
<p>Or alternatively using the new-to-us <code>glimpse()</code> function</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(Data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in `glimpse()`:
! could not find function "glimpse"</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Checkpoint 1">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Checkpoint 1
</div>
</div>
<div class="callout-body-container callout-body">
<p>This however returns an error. Any idea why this might be occuring?</p>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We haven't attached/loaded the package in which the function glimpse is within</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Checkpoint 2">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Checkpoint 2
</div>
</div>
<div class="callout-body-container callout-body">
<p>How would we locate a package a not-yet-loaded function is within?</p>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We can use double ? to search all installed packages for a function, regardless</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co"># if the package is attached to the environment or not</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>??glimpse</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><img src="images/02_Glimpse.png" class="img-fluid"></p>
<p>From the list of search matches (in the right secondary sidebar), it looks likely that the <code>glimpse()</code> function in the <code>dplyr</code> package was the one we were looking for. This is one the main tidyverse packages we will be using throughout the course. Let’s attach it to our environment via the <code>library()</code> call first and try running <code>glimpse()</code> again.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(Data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 196
Columns: 31
$ bid               &lt;chr&gt; "INF0052", "INF0100", "INF0100", "INF0100", "INF0179…
$ timepoint         &lt;int&gt; 0, 0, 4, 9, 0, 4, 9, 4, 9, 0, 0, 4, 9, 0, 4, 9, 4, 9…
$ Condition         &lt;chr&gt; "Ctrl", "Ctrl", "Ctrl", "Ctrl", "Ctrl", "Ctrl", "Ctr…
$ Date              &lt;chr&gt; "2025-07-26", "2025-07-26", "2025-07-26", "2025-07-2…
$ infant_sex        &lt;chr&gt; "Male", "Male", "Male", "Male", "Male", "Male", "Mal…
$ ptype             &lt;chr&gt; "HEU-hi", "HEU-lo", "HEU-lo", "HEU-lo", "HU", "HU", …
$ root              &lt;int&gt; 2098368, 2020184, 1155040, 358624, 1362216, 1044808,…
$ singletsFSC       &lt;int&gt; 1894070, 1791890, 1033320, 328624, 1206309, 917398, …
$ singletsSSC       &lt;int&gt; 1666179, 1697083, 875465, 289327, 1032946, 735579, 9…
$ singletsSSCB      &lt;int&gt; 1537396, 1579098, 845446, 276289, 982736, 685592, 94…
$ CD45              &lt;dbl&gt; 0.5952943, 0.9106762, 0.9705765, 0.9819573, 0.957259…
$ NotMonocytes      &lt;dbl&gt; 0.8820349, 0.9052256, 0.9845400, 0.9855070, 0.955627…
$ nonDebris         &lt;dbl&gt; 0.8627649, 0.8602660, 0.9578793, 0.9412615, 0.840783…
$ lymphocytes       &lt;dbl&gt; 0.6420138, 0.2145848, 0.7403110, 0.6511588, 0.705478…
$ live              &lt;dbl&gt; 0.9020581, 0.8908981, 0.8757665, 0.9153242, 0.895214…
$ `Dump+`           &lt;dbl&gt; 0.21090996, 0.06252775, 0.20023803, 0.21469246, 0.33…
$ `Dump-`           &lt;dbl&gt; 0.6911482, 0.8283703, 0.6755285, 0.7006317, 0.556895…
$ Tcells            &lt;dbl&gt; 0.2804264, 0.6748298, 0.6119129, 0.6314431, 0.439643…
$ `Vd2+`            &lt;dbl&gt; 0.008120361, 0.007265620, 0.004651313, 0.011348967, …
$ `Vd2-`            &lt;dbl&gt; 0.9918796, 0.9927344, 0.9953487, 0.9886510, 0.995246…
$ `Va7.2+`          &lt;dbl&gt; 0.014480704, 0.015774991, 0.015794019, 0.017023451, …
$ `Va7.2-`          &lt;dbl&gt; 0.9773989, 0.9769594, 0.9795547, 0.9716276, 0.981924…
$ `CD4+`            &lt;dbl&gt; 0.6341164, 0.6119112, 0.6639621, 0.4378944, 0.739256…
$ `CD4-`            &lt;dbl&gt; 0.3432825, 0.3650482, 0.3155925, 0.5337331, 0.242668…
$ `CD8+`            &lt;dbl&gt; 0.2734826, 0.3357696, 0.2862104, 0.4861231, 0.195063…
$ `CD8-`            &lt;dbl&gt; 0.06979990, 0.02927858, 0.02938209, 0.04761008, 0.04…
$ Tcells_count      &lt;int&gt; 164771, 208241, 371723, 111552, 291777, 271870, 4879…
$ lymphocytes_count &lt;int&gt; 587573, 308583, 607477, 176662, 663667, 510730, 7262…
$ Monocytes         &lt;dbl&gt; 0.11796509, 0.09477437, 0.01545999, 0.01449297, 0.04…
$ Debris            &lt;dbl&gt; 0.13723513, 0.13973396, 0.04212072, 0.05873854, 0.15…
$ CD45_count        &lt;int&gt; 915203, 1438047, 820570, 271304, 940733, 675857, 921…</code></pre>
</div>
</div>
<p>We notice that while similar to the <code>str()</code> output, <code>glimpse()</code> handles spacing a little differently, and includes the dimensions at the top. However, we can also retrieve the dimensions directly using the <code>dim()</code> function (which maintains the row followed by column position convention of base R (ex. [196,31]))</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(Data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 196  31</code></pre>
</div>
</div>
</section>
<section id="column-value-type" class="level2">
<h2 class="anchored" data-anchor-id="column-value-type">Column value type</h2>
<p>As we saw last week, functions often need values that match a certain type (the paintbrush needing paint analogy). As we inspect the columns of Data, we can notice some of the columns contain values within that are character (ie. “char”) values. Others appear to contain numeric values (which are <a href="https://www.r-bloggers.com/2023/09/understanding-data-types-in-r/">subtyped</a> as either double (“ie. dbl”) or integer (ie. “int”)). At first glance, we do not appear to have any logical (ie. TRUE or FALSE) columns in this dataset.</p>
<p><img src="images/03_ColumnClass.png" class="img-fluid"></p>
<p>If we were trying to verify type of values contained within a data.frame column, we could employ several similarly-named functions (<code>is.character()</code>, <code>is.numeric()</code> or <code>is.logical()</code>) to check</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># colnames(Data)  # To recheck the column names</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">is.character</span>(Data<span class="sc">$</span>bid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.numeric</span>(Data<span class="sc">$</span>bid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># colnames(Data)  # To recheck the column names</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">is.character</span>(Data<span class="sc">$</span>Tcells_count)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<p>For numeric columns using the <code>is.numeric()</code> function, we can also be <a href="https://www.r-bloggers.com/2023/09/understanding-data-types-in-r/">subtype</a> specific using either <code>is.integer()</code> or <code>is.double()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># colnames(Data)  # To recheck the column names</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">is.numeric</span>(Data<span class="sc">$</span>Tcells_count)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.integer</span>(Data<span class="sc">$</span>Tcells_count)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.double</span>(Data<span class="sc">$</span>Tcells_count)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Reminder">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Reminder
</div>
</div>
<div class="callout-body-container callout-body">
<p>As we observed last week with keywords, column names that contain <a href="https://ssojet.com/escaping/regex-escaping-in-r#understanding-the-need-for-escaping-special-characters">special characters</a> like $ or spaces will need to be surrounded with tick marks in order for the function to be able to run.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># colnames(Data)  # To recheck the column names</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">is.numeric</span>(Data<span class="sc">$</span>CD8<span class="sc">-</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in parse(text = input): &lt;text&gt;:2:21: unexpected ')'
1: # colnames(Data)  # To recheck the column names
2: is.numeric(Data$CD8-)
                       ^</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># colnames(Data)  # To recheck the column names</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">is.numeric</span>(Data<span class="sc">$</span><span class="st">`</span><span class="at">CD8-</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</section>
<section id="select-columns" class="level2">
<h2 class="anchored" data-anchor-id="select-columns">select (Columns)</h2>
<p>Now that we have read in our data, and have a general picture of the structure and contents, lets start learning the main <code>dplyr</code> functions we will be using throughout the course. To do this, lets go ahead and attach <code>dplyr</code> to our local environment via the <code>library()</code> call.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will start with the <code>select()</code> function. It is used to “select” a column from a data.frame type object. In the simplest usage, we provide the name of our data.frame variable/object as the first argument after the opening parenthesis. This is then followed by the name of the column we want to select as the second argument (let’s place around the “” around the column name for now)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>DateColumn <span class="ot">&lt;-</span> <span class="fu">select</span>(Data, <span class="st">"Date"</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>DateColumn[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "2025-07-26" "2025-07-26" "2025-07-26" "2025-07-26" "2025-07-26"
 [6] "2025-07-26" "2025-07-26" "2025-07-26" "2025-07-26" "2025-07-26"</code></pre>
</div>
</div>
<p>This results in the column being selected, resulting in the new object containing only that subsetted out column from the original Data object.</p>
<section id="pipe-operators" class="level3">
<h3 class="anchored" data-anchor-id="pipe-operators">Pipe Operators</h3>
<p>While the above line of code works to select a column, when you encounter <code>select()</code> out in the wild, it will more often be in a line of code that looks like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>DateColumn <span class="ot">&lt;-</span> Data <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="st">"Date"</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>DateColumn[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "2025-07-26" "2025-07-26" "2025-07-26" "2025-07-26" "2025-07-26"
 [6] "2025-07-26" "2025-07-26" "2025-07-26" "2025-07-26" "2025-07-26"</code></pre>
</div>
</div>
<p>… <strong>“What in the world is that thing |&gt; ?”</strong> …</p>
<p>Glad you asked! An useful feature of the tidyverse packages is their use of <a href="https://r4ds.had.co.nz/pipes.html">pipes</a> (either the original <code>magrittr</code> package’s “%&gt;%” or <code>base R version &gt;4.1.0's</code> “|&gt;”“), usually appearing like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># magrittr %&gt;% pipe</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>DateColumn <span class="ot">&lt;-</span> Data <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="st">"Date"</span>)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="co"># base R |&gt; pipe</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>DateColumn <span class="ot">&lt;-</span> Data <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="st">"Date"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>… <strong>“How do we interpret/read that line of code?”</strong> …</p>
<p>Let’s break it down, starting off just to the right of the assignment arrow (&lt;-) with our data.frame “Data”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>Data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We then proceed to read to the right, adding in our pipe operator. The pipe essentially serves as an intermediate passing the contents of data onward to the subsequent function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>Data <span class="sc">|&gt;</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In our case, this subsequent function is the <code>select()</code> function, which will select a particular column from the available data. When using the pipe, the first argument slot we saw for “select(Data,”Date”)” is occupied by the contents Data that are being passed by the pipe.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>Data <span class="sc">|&gt;</span> <span class="fu">select</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To complete the transfer, we provide the desired column name to <code>select()</code> to act on (“Date” in this case)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>Data <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="st">"Date"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In summary, contents of Data are passed to the pipe, and select runs on those contents to select the Date column</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>Data <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="st">"Date"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>One of the main advantages for using pipes, is they can be linked together, passing resulting objects of one operation on to the next pipe and subsequent function. We can see this in operation in the example below where we hand off the isolated “Date” column to the <code>nrow()</code> function to determine number of rows. We will use pipes throughout the course, so you will gradually gain familiarity as you encounter them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>Data <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="st">"Date"</span>) <span class="sc">|&gt;</span> <span class="fu">nrow</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 196</code></pre>
</div>
</div>
<p>For those with prior R experience, you will be more familiar with the older magrittr %&gt;% pipe. The base R |&gt; pipe operator was introduced starting with R version 4.1.0. While mostly interchangeable, they have a <a href="https://tidyverse.org/blog/2023/04/base-vs-magrittr-pipe/">few nuances</a> that come into play for more advance use cases. You are welcome to use whichever you prefer (my current preference is |&gt; as it’s one less key to press).</p>
</section>
<section id="r-quirks" class="level3">
<h3 class="anchored" data-anchor-id="r-quirks">R Quirks</h3>
<div class="callout callout-style-default callout-note callout-titled" title="Odd R Behavior # 1">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Odd R Behavior # 1
</div>
</div>
<div class="callout-body-container callout-body">
<p>While we used “” around the column name in our previous example, unlike what we encountered with <code>install.packages()</code> when we forget to include quotation marks, <code>select()</code> still retrieves the correct column despite Date not being an environment variable:</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>Data <span class="sc">|&gt;</span> <span class="fu">select</span>(Date) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Date
1 2025-07-26
2 2025-07-26
3 2025-07-26</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title=".">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
.
</div>
</div>
<div class="callout-body-container callout-body">
<p>The reasons for this Odd R behaviour are nuanced and for <a href="https://adv-r.hadley.nz/evaluation.html">another day</a>. For now, think of it as <code>dplyr</code> R package is picking up the slack, and using context to infer it’s a column name and not an environmental variable/object.</p>
</div>
</div>
</section>
<section id="selecting-multiple-columns" class="level3">
<h3 class="anchored" data-anchor-id="selecting-multiple-columns">Selecting multiple columns</h3>
<p>Since we are able to select one column, can we select multiple (similar to a [Data[,2:5]] approach in base R)? We can, and they can be positioned anywhere within the data.frame:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>Subset <span class="ot">&lt;-</span> Data <span class="sc">|&gt;</span> <span class="fu">select</span>(bid, timepoint, Condition, Tcells, <span class="st">`</span><span class="at">CD8+</span><span class="st">`</span>, <span class="st">`</span><span class="at">CD4+</span><span class="st">`</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Subset, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      bid timepoint Condition    Tcells      CD8+      CD4+
1 INF0052         0      Ctrl 0.2804264 0.2734826 0.6341164
2 INF0100         0      Ctrl 0.6748298 0.3357696 0.6119112
3 INF0100         4      Ctrl 0.6119129 0.2862104 0.6639621</code></pre>
</div>
</div>
<p>You will notice that the order in which we selected the columns will dictate their position in the subsetted data.frame object:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>Subset <span class="ot">&lt;-</span> Data <span class="sc">|&gt;</span> <span class="fu">select</span>(bid, Tcells, <span class="st">`</span><span class="at">CD8+</span><span class="st">`</span>, <span class="st">`</span><span class="at">CD4+</span><span class="st">`</span>, timepoint, Condition, )</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Subset, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      bid    Tcells      CD8+      CD4+ timepoint Condition
1 INF0052 0.2804264 0.2734826 0.6341164         0      Ctrl
2 INF0100 0.6748298 0.3357696 0.6119112         0      Ctrl
3 INF0100 0.6119129 0.2862104 0.6639621         4      Ctrl</code></pre>
</div>
</div>
</section>
</section>
<section id="relocate" class="level2">
<h2 class="anchored" data-anchor-id="relocate">relocate</h2>
<p>Alternatively, we occasionally want to move one column. While we could respecify the location using <code>select()</code>, specifying the names of all the other columns out in a line of code to just to rearrange one does not sound like a good use of time. For this reason, the second <code>dplyr</code> function we will be learning is the <code>relocate()</code> function.</p>
<p>Looking at our Data object, let’s say we wanted to move the Tcells column from its current location to the second column position (right after the bid column). The line of code to do so would look like:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>Data <span class="sc">|&gt;</span> <span class="fu">relocate</span>(Tcells, <span class="at">.after=</span>bid) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      bid    Tcells timepoint Condition       Date infant_sex  ptype    root
1 INF0052 0.2804264         0      Ctrl 2025-07-26       Male HEU-hi 2098368
2 INF0100 0.6748298         0      Ctrl 2025-07-26       Male HEU-lo 2020184
3 INF0100 0.6119129         4      Ctrl 2025-07-26       Male HEU-lo 1155040
  singletsFSC singletsSSC singletsSSCB      CD45 NotMonocytes nonDebris
1     1894070     1666179      1537396 0.5952943    0.8820349 0.8627649
2     1791890     1697083      1579098 0.9106762    0.9052256 0.8602660
3     1033320      875465       845446 0.9705765    0.9845400 0.9578793
  lymphocytes      live      Dump+     Dump-        Vd2+      Vd2-     Va7.2+
1   0.6420138 0.9020581 0.21090996 0.6911482 0.008120361 0.9918796 0.01448070
2   0.2145848 0.8908981 0.06252775 0.8283703 0.007265620 0.9927344 0.01577499
3   0.7403110 0.8757665 0.20023803 0.6755285 0.004651313 0.9953487 0.01579402
     Va7.2-      CD4+      CD4-      CD8+       CD8- Tcells_count
1 0.9773989 0.6341164 0.3432825 0.2734826 0.06979990       164771
2 0.9769594 0.6119112 0.3650482 0.3357696 0.02927858       208241
3 0.9795547 0.6639621 0.3155925 0.2862104 0.02938209       371723
  lymphocytes_count  Monocytes     Debris CD45_count
1            587573 0.11796509 0.13723513     915203
2            308583 0.09477437 0.13973396    1438047
3            607477 0.01545999 0.04212072     820570</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># |&gt; head(3) is used only to make the website output visualization manageable :D</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Similar to what we saw with <code>select()</code>, this approach can also be used for more than 1 column:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>Data <span class="sc">|&gt;</span> <span class="fu">relocate</span>(Tcells, Monocytes, <span class="at">.after=</span>bid) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      bid    Tcells  Monocytes timepoint Condition       Date infant_sex  ptype
1 INF0052 0.2804264 0.11796509         0      Ctrl 2025-07-26       Male HEU-hi
2 INF0100 0.6748298 0.09477437         0      Ctrl 2025-07-26       Male HEU-lo
3 INF0100 0.6119129 0.01545999         4      Ctrl 2025-07-26       Male HEU-lo
     root singletsFSC singletsSSC singletsSSCB      CD45 NotMonocytes nonDebris
1 2098368     1894070     1666179      1537396 0.5952943    0.8820349 0.8627649
2 2020184     1791890     1697083      1579098 0.9106762    0.9052256 0.8602660
3 1155040     1033320      875465       845446 0.9705765    0.9845400 0.9578793
  lymphocytes      live      Dump+     Dump-        Vd2+      Vd2-     Va7.2+
1   0.6420138 0.9020581 0.21090996 0.6911482 0.008120361 0.9918796 0.01448070
2   0.2145848 0.8908981 0.06252775 0.8283703 0.007265620 0.9927344 0.01577499
3   0.7403110 0.8757665 0.20023803 0.6755285 0.004651313 0.9953487 0.01579402
     Va7.2-      CD4+      CD4-      CD8+       CD8- Tcells_count
1 0.9773989 0.6341164 0.3432825 0.2734826 0.06979990       164771
2 0.9769594 0.6119112 0.3650482 0.3357696 0.02927858       208241
3 0.9795547 0.6639621 0.3155925 0.2862104 0.02938209       371723
  lymphocytes_count     Debris CD45_count
1            587573 0.13723513     915203
2            308583 0.13973396    1438047
3            607477 0.04212072     820570</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># |&gt; head(3) is used only to make the website output visualization manageable :D</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can also modify the argument so that columns are placed before a certain column</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>Data <span class="sc">|&gt;</span> <span class="fu">relocate</span>(Tcells, <span class="at">.before=</span>Date) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      bid timepoint Condition    Tcells       Date infant_sex  ptype    root
1 INF0052         0      Ctrl 0.2804264 2025-07-26       Male HEU-hi 2098368
2 INF0100         0      Ctrl 0.6748298 2025-07-26       Male HEU-lo 2020184
3 INF0100         4      Ctrl 0.6119129 2025-07-26       Male HEU-lo 1155040
  singletsFSC singletsSSC singletsSSCB      CD45 NotMonocytes nonDebris
1     1894070     1666179      1537396 0.5952943    0.8820349 0.8627649
2     1791890     1697083      1579098 0.9106762    0.9052256 0.8602660
3     1033320      875465       845446 0.9705765    0.9845400 0.9578793
  lymphocytes      live      Dump+     Dump-        Vd2+      Vd2-     Va7.2+
1   0.6420138 0.9020581 0.21090996 0.6911482 0.008120361 0.9918796 0.01448070
2   0.2145848 0.8908981 0.06252775 0.8283703 0.007265620 0.9927344 0.01577499
3   0.7403110 0.8757665 0.20023803 0.6755285 0.004651313 0.9953487 0.01579402
     Va7.2-      CD4+      CD4-      CD8+       CD8- Tcells_count
1 0.9773989 0.6341164 0.3432825 0.2734826 0.06979990       164771
2 0.9769594 0.6119112 0.3650482 0.3357696 0.02927858       208241
3 0.9795547 0.6639621 0.3155925 0.2862104 0.02938209       371723
  lymphocytes_count  Monocytes     Debris CD45_count
1            587573 0.11796509 0.13723513     915203
2            308583 0.09477437 0.13973396    1438047
3            607477 0.01545999 0.04212072     820570</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># |&gt; head(3) is used only to make the website output visualization manageable :D</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And as we might suspect, we could specify a column index location rather than using a column name.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>Data <span class="sc">|&gt;</span> <span class="fu">relocate</span>(Date, <span class="at">.before=</span><span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Date     bid timepoint Condition infant_sex  ptype    root singletsFSC
1 2025-07-26 INF0052         0      Ctrl       Male HEU-hi 2098368     1894070
2 2025-07-26 INF0100         0      Ctrl       Male HEU-lo 2020184     1791890
3 2025-07-26 INF0100         4      Ctrl       Male HEU-lo 1155040     1033320
  singletsSSC singletsSSCB      CD45 NotMonocytes nonDebris lymphocytes
1     1666179      1537396 0.5952943    0.8820349 0.8627649   0.6420138
2     1697083      1579098 0.9106762    0.9052256 0.8602660   0.2145848
3      875465       845446 0.9705765    0.9845400 0.9578793   0.7403110
       live      Dump+     Dump-    Tcells        Vd2+      Vd2-     Va7.2+
1 0.9020581 0.21090996 0.6911482 0.2804264 0.008120361 0.9918796 0.01448070
2 0.8908981 0.06252775 0.8283703 0.6748298 0.007265620 0.9927344 0.01577499
3 0.8757665 0.20023803 0.6755285 0.6119129 0.004651313 0.9953487 0.01579402
     Va7.2-      CD4+      CD4-      CD8+       CD8- Tcells_count
1 0.9773989 0.6341164 0.3432825 0.2734826 0.06979990       164771
2 0.9769594 0.6119112 0.3650482 0.3357696 0.02927858       208241
3 0.9795547 0.6639621 0.3155925 0.2862104 0.02938209       371723
  lymphocytes_count  Monocytes     Debris CD45_count
1            587573 0.11796509 0.13723513     915203
2            308583 0.09477437 0.13973396    1438047
3            607477 0.01545999 0.04212072     820570</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># |&gt; head(3) is used only to make the website output visualization manageable :D</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="rename" class="level2">
<h2 class="anchored" data-anchor-id="rename">rename</h2>
<p>At this point, we are able to both move and select particular columns, allowing us to rearrange and subset a larger data.frame object however we want it to appear. However, as we encountered, some of the names contain special characters and spaces, requiring use of tick marks (``) to avoid issues. How can we change a column name?</p>
<p>In base R, we could change individual column names by assigning a new value with the assignment arrow to the corresponding column name index. For example, looking at our Subset object, wen could rename CD8+ as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Subset)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "bid"       "Tcells"    "CD8+"      "CD4+"      "timepoint" "Condition"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Subset)[<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "CD8+"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Subset)[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="st">"CD8Positive"</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Subset)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "bid"         "Tcells"      "CD8Positive" "CD4+"        "timepoint"  
[6] "Condition"  </code></pre>
</div>
</div>
<p>With the tidyverse, we can use the <code>rename()</code> function which removes the need to look up the column index number. The way we write the argument is placing within the parenthesis the old name to the right of the equals sign, with the new name to the left</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>Renamed <span class="ot">&lt;-</span> Subset <span class="sc">|&gt;</span> <span class="fu">rename</span>(<span class="at">CD4_Positive =</span> <span class="st">`</span><span class="at">CD4+</span><span class="st">`</span>)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Renamed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "bid"          "Tcells"       "CD8Positive"  "CD4_Positive" "timepoint"   
[6] "Condition"   </code></pre>
</div>
</div>
<p>If we wanted to rename multiple column names at once, we would just need to include a comma between the individual rename arguments within the parenthesis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>Renamed_Multiple <span class="ot">&lt;-</span> Subset <span class="sc">|&gt;</span> <span class="fu">rename</span>(<span class="at">specimen =</span> bid, <span class="at">timepoint_months =</span> timepoint, <span class="at">stimulation =</span> Condition, <span class="at">CD4Positive=</span><span class="st">`</span><span class="at">CD4+</span><span class="st">`</span>)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Renamed_Multiple)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "specimen"         "Tcells"           "CD8Positive"      "CD4Positive"     
[5] "timepoint_months" "stimulation"     </code></pre>
</div>
</div>
</section>
<section id="pull" class="level2">
<h2 class="anchored" data-anchor-id="pull">pull</h2>
<p>Sometimes, we may want to retrieve individual values present in a column, to use within either a vector or a list. We can do this using the <code>pull()</code> function, which will retrieve the column contents and strip the column formatting</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>Data <span class="sc">|&gt;</span> <span class="fu">pull</span>(Date) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2025-07-26" "2025-07-26" "2025-07-26" "2025-07-26" "2025-07-26"</code></pre>
</div>
</div>
<p>This can be useful when we are doing data exploration, and trying to determine how many unique variants might be present. For example, if we wanted to see what days individual samples were acquired, we could <code>pull()</code> the data and pass it to the <code>unique()</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>Data <span class="sc">|&gt;</span> <span class="fu">pull</span>(Date) <span class="sc">|&gt;</span> <span class="fu">unique</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2025-07-26" "2025-07-29" "2025-07-31" "2025-08-05" "2025-08-07"
[6] "2025-08-22" "2025-08-28" "2025-08-30"</code></pre>
</div>
</div>
</section>
<section id="filter-rows" class="level2">
<h2 class="anchored" data-anchor-id="filter-rows">filter (Rows)</h2>
<p>So far, we have been working with <code>dplyr</code> functions primarily used when working with and subsetting columns (including <code>select()</code>, <code>pull()</code>, <code>rename()</code> and <code>relocate()</code>). What if we wanted to work with rows of a data.frame? This is where the <code>filter()</code> function is used.</p>
<p>The Condition column in this Dataset appears to be indicating whether the samples were stimulated. Let’s see how many unique values are contained within that column</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>Data <span class="sc">|&gt;</span> <span class="fu">pull</span>(Condition) <span class="sc">|&gt;</span> <span class="fu">unique</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Ctrl" "PPD"  "SEB" </code></pre>
</div>
</div>
<p>In the case of this dataset, looks like the .fcs files where treated with either left alone, treated with <a href="https://en.wikipedia.org/wiki/Tuberculin">PPD (Purified Protein Derrivative)</a> or <a href="https://en.wikipedia.org/wiki/Enterotoxin_type_B">SEB</a>. What if we wanted to subset only those treated with PPD?</p>
<p>Within <code>filter()</code>, we would specify the column name as the first argument, and ask that only values equal to (==) “PPD” be returned. Notice in this case, “” are needed, as we are asking for a matching character value.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>PPDOnly <span class="ot">&lt;-</span> Data <span class="sc">|&gt;</span> <span class="fu">filter</span>(Condition <span class="sc">==</span> <span class="st">"PPD"</span>)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(PPDOnly, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      bid timepoint Condition       Date infant_sex  ptype    root singletsFSC
1 INF0052         0       PPD 2025-07-26       Male HEU-hi 2363512     2136616
2 INF0100         0       PPD 2025-07-26       Male HEU-lo 2049112     1821676
3 INF0100         4       PPD 2025-07-26       Male HEU-lo 1063496      946587
4 INF0100         9       PPD 2025-07-26       Male HEU-lo  788368      714198
5 INF0179         0       PPD 2025-07-26       Male     HU 1380336     1242311
  singletsSSC singletsSSCB      CD45 NotMonocytes nonDebris lymphocytes
1     1875394      1732620 0.5873838    0.8619837 0.8429685   0.6408044
2     1717636      1597085 0.9063081    0.9251961 0.8771889   0.2174284
3      796056       767297 0.9709891    0.9848719 0.9556049   0.7313503
4      626387       600011 0.9822803    0.9842139 0.8123041   0.6223228
5     1047081      1000877 0.9470275    0.9575685 0.9134438   0.6996502
       live      Dump+     Dump-    Tcells        Vd2+      Vd2-     Va7.2+
1 0.9009254 0.20743228 0.6934931 0.2835676 0.007408209 0.9925918 0.01507057
2 0.8929673 0.06181426 0.8311531 0.6735798 0.007137230 0.9928628 0.01671801
3 0.8782307 0.20727202 0.6709587 0.5989873 0.005254643 0.9947454 0.01609790
4 0.9566639 0.23164587 0.7250180 0.6489405 0.011935922 0.9880641 0.01855298
5 0.8856898 0.33186111 0.5538287 0.4441538 0.004382972 0.9956170 0.01297237
     Va7.2-      CD4+      CD4-      CD8+       CD8- Tcells_count
1 0.9775212 0.6340345 0.3434867 0.2744119 0.06907479       184930
2 0.9761448 0.6145707 0.3615741 0.3312279 0.03034620       211987
3 0.9786475 0.6559480 0.3226994 0.2912084 0.03149109       326378
4 0.9695111 0.4306889 0.5388222 0.4908558 0.04796636       238021
5 0.9826447 0.7499194 0.2327253 0.1850897 0.04763554       294549
  lymphocytes_count  Monocytes     Debris CD45_count
1            652155 0.13801632 0.15703150    1017713
2            314717 0.07480391 0.12281107    1447451
3            544883 0.01512811 0.04439511     745037
4            366784 0.01578611 0.18769586     589379
5            663169 0.04243146 0.08655621     947858</code></pre>
</div>
</div>
<p>While this works, using “==” to match can glitch, especially with character values. Using the %in% operator is a better way of identifying and extracting only the rows whose Condition column contains “PPD”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>Data <span class="sc">|&gt;</span> <span class="fu">filter</span>(Condition <span class="sc">%in%</span> <span class="st">"PPD"</span>) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      bid timepoint Condition       Date infant_sex  ptype    root singletsFSC
1 INF0052         0       PPD 2025-07-26       Male HEU-hi 2363512     2136616
2 INF0100         0       PPD 2025-07-26       Male HEU-lo 2049112     1821676
3 INF0100         4       PPD 2025-07-26       Male HEU-lo 1063496      946587
4 INF0100         9       PPD 2025-07-26       Male HEU-lo  788368      714198
5 INF0179         0       PPD 2025-07-26       Male     HU 1380336     1242311
  singletsSSC singletsSSCB      CD45 NotMonocytes nonDebris lymphocytes
1     1875394      1732620 0.5873838    0.8619837 0.8429685   0.6408044
2     1717636      1597085 0.9063081    0.9251961 0.8771889   0.2174284
3      796056       767297 0.9709891    0.9848719 0.9556049   0.7313503
4      626387       600011 0.9822803    0.9842139 0.8123041   0.6223228
5     1047081      1000877 0.9470275    0.9575685 0.9134438   0.6996502
       live      Dump+     Dump-    Tcells        Vd2+      Vd2-     Va7.2+
1 0.9009254 0.20743228 0.6934931 0.2835676 0.007408209 0.9925918 0.01507057
2 0.8929673 0.06181426 0.8311531 0.6735798 0.007137230 0.9928628 0.01671801
3 0.8782307 0.20727202 0.6709587 0.5989873 0.005254643 0.9947454 0.01609790
4 0.9566639 0.23164587 0.7250180 0.6489405 0.011935922 0.9880641 0.01855298
5 0.8856898 0.33186111 0.5538287 0.4441538 0.004382972 0.9956170 0.01297237
     Va7.2-      CD4+      CD4-      CD8+       CD8- Tcells_count
1 0.9775212 0.6340345 0.3434867 0.2744119 0.06907479       184930
2 0.9761448 0.6145707 0.3615741 0.3312279 0.03034620       211987
3 0.9786475 0.6559480 0.3226994 0.2912084 0.03149109       326378
4 0.9695111 0.4306889 0.5388222 0.4908558 0.04796636       238021
5 0.9826447 0.7499194 0.2327253 0.1850897 0.04763554       294549
  lymphocytes_count  Monocytes     Debris CD45_count
1            652155 0.13801632 0.15703150    1017713
2            314717 0.07480391 0.12281107    1447451
3            544883 0.01512811 0.04439511     745037
4            366784 0.01578611 0.18769586     589379
5            663169 0.04243146 0.08655621     947858</code></pre>
</div>
</div>
<p>Similar to what we saw for <code>select()</code>, we can grab rows that contain various values at once. We would just need to modify the second part of the argument. If we wanted to grab rows whose Condition column contained either PPD or SEB, we would need to provide that argument as a vector, placing both within <code>c()</code>/</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>Data <span class="sc">|&gt;</span> <span class="fu">filter</span>(Condition <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"PPD"</span>, <span class="st">"SEB"</span>)) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      bid timepoint Condition       Date infant_sex  ptype    root singletsFSC
1 INF0052         0       PPD 2025-07-26       Male HEU-hi 2363512     2136616
2 INF0100         0       PPD 2025-07-26       Male HEU-lo 2049112     1821676
3 INF0100         4       PPD 2025-07-26       Male HEU-lo 1063496      946587
4 INF0100         9       PPD 2025-07-26       Male HEU-lo  788368      714198
5 INF0179         0       PPD 2025-07-26       Male     HU 1380336     1242311
  singletsSSC singletsSSCB      CD45 NotMonocytes nonDebris lymphocytes
1     1875394      1732620 0.5873838    0.8619837 0.8429685   0.6408044
2     1717636      1597085 0.9063081    0.9251961 0.8771889   0.2174284
3      796056       767297 0.9709891    0.9848719 0.9556049   0.7313503
4      626387       600011 0.9822803    0.9842139 0.8123041   0.6223228
5     1047081      1000877 0.9470275    0.9575685 0.9134438   0.6996502
       live      Dump+     Dump-    Tcells        Vd2+      Vd2-     Va7.2+
1 0.9009254 0.20743228 0.6934931 0.2835676 0.007408209 0.9925918 0.01507057
2 0.8929673 0.06181426 0.8311531 0.6735798 0.007137230 0.9928628 0.01671801
3 0.8782307 0.20727202 0.6709587 0.5989873 0.005254643 0.9947454 0.01609790
4 0.9566639 0.23164587 0.7250180 0.6489405 0.011935922 0.9880641 0.01855298
5 0.8856898 0.33186111 0.5538287 0.4441538 0.004382972 0.9956170 0.01297237
     Va7.2-      CD4+      CD4-      CD8+       CD8- Tcells_count
1 0.9775212 0.6340345 0.3434867 0.2744119 0.06907479       184930
2 0.9761448 0.6145707 0.3615741 0.3312279 0.03034620       211987
3 0.9786475 0.6559480 0.3226994 0.2912084 0.03149109       326378
4 0.9695111 0.4306889 0.5388222 0.4908558 0.04796636       238021
5 0.9826447 0.7499194 0.2327253 0.1850897 0.04763554       294549
  lymphocytes_count  Monocytes     Debris CD45_count
1            652155 0.13801632 0.15703150    1017713
2            314717 0.07480391 0.12281107    1447451
3            544883 0.01512811 0.04439511     745037
4            366784 0.01578611 0.18769586     589379
5            663169 0.04243146 0.08655621     947858</code></pre>
</div>
</div>
<p>Alternatively, we could have set up the vector externally, and then provided it to <code>filter()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>TheseConditions <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"PPD"</span>, <span class="st">"SEB"</span>)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>Data <span class="sc">|&gt;</span> <span class="fu">filter</span>(Condition <span class="sc">%in%</span> TheseConditions) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      bid timepoint Condition       Date infant_sex  ptype    root singletsFSC
1 INF0052         0       PPD 2025-07-26       Male HEU-hi 2363512     2136616
2 INF0100         0       PPD 2025-07-26       Male HEU-lo 2049112     1821676
3 INF0100         4       PPD 2025-07-26       Male HEU-lo 1063496      946587
4 INF0100         9       PPD 2025-07-26       Male HEU-lo  788368      714198
5 INF0179         0       PPD 2025-07-26       Male     HU 1380336     1242311
  singletsSSC singletsSSCB      CD45 NotMonocytes nonDebris lymphocytes
1     1875394      1732620 0.5873838    0.8619837 0.8429685   0.6408044
2     1717636      1597085 0.9063081    0.9251961 0.8771889   0.2174284
3      796056       767297 0.9709891    0.9848719 0.9556049   0.7313503
4      626387       600011 0.9822803    0.9842139 0.8123041   0.6223228
5     1047081      1000877 0.9470275    0.9575685 0.9134438   0.6996502
       live      Dump+     Dump-    Tcells        Vd2+      Vd2-     Va7.2+
1 0.9009254 0.20743228 0.6934931 0.2835676 0.007408209 0.9925918 0.01507057
2 0.8929673 0.06181426 0.8311531 0.6735798 0.007137230 0.9928628 0.01671801
3 0.8782307 0.20727202 0.6709587 0.5989873 0.005254643 0.9947454 0.01609790
4 0.9566639 0.23164587 0.7250180 0.6489405 0.011935922 0.9880641 0.01855298
5 0.8856898 0.33186111 0.5538287 0.4441538 0.004382972 0.9956170 0.01297237
     Va7.2-      CD4+      CD4-      CD8+       CD8- Tcells_count
1 0.9775212 0.6340345 0.3434867 0.2744119 0.06907479       184930
2 0.9761448 0.6145707 0.3615741 0.3312279 0.03034620       211987
3 0.9786475 0.6559480 0.3226994 0.2912084 0.03149109       326378
4 0.9695111 0.4306889 0.5388222 0.4908558 0.04796636       238021
5 0.9826447 0.7499194 0.2327253 0.1850897 0.04763554       294549
  lymphocytes_count  Monocytes     Debris CD45_count
1            652155 0.13801632 0.15703150    1017713
2            314717 0.07480391 0.12281107    1447451
3            544883 0.01512811 0.04439511     745037
4            366784 0.01578611 0.18769586     589379
5            663169 0.04243146 0.08655621     947858</code></pre>
</div>
</div>
<p>While this works when we have a limited number of variant condition values, what if had many more but only wanted to exclude one value? As we saw when learning about <a href="../../course/02_FilePaths/index.html">Conditionals</a>, when we add a ! in front of a logical value, we get the opposite logical value returned</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>IsThisASpectralInstrument <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="sc">!</span>IsThisASpectralInstrument</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<p>In the context of the <code>dplyr</code> package, we can use ! within the <code>filter()</code> to remove rows that contain a certain value</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>Subset <span class="ot">&lt;-</span> Data <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span>Condition <span class="sc">%in%</span> <span class="st">"SEB"</span>)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>Subset <span class="sc">|&gt;</span> <span class="fu">pull</span>(Condition) <span class="sc">|&gt;</span> <span class="fu">unique</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Ctrl" "PPD" </code></pre>
</div>
</div>
<p>Likewise, we can also use it with the <code>select()</code> to exclude columns we don’t want to include</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>Subset <span class="ot">&lt;-</span> Data <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">!</span>timepoint)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>Subset[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      bid Condition       Date infant_sex  ptype    root singletsFSC
1 INF0052      Ctrl 2025-07-26       Male HEU-hi 2098368     1894070
2 INF0100      Ctrl 2025-07-26       Male HEU-lo 2020184     1791890
3 INF0100      Ctrl 2025-07-26       Male HEU-lo 1155040     1033320
  singletsSSC singletsSSCB      CD45 NotMonocytes nonDebris lymphocytes
1     1666179      1537396 0.5952943    0.8820349 0.8627649   0.6420138
2     1697083      1579098 0.9106762    0.9052256 0.8602660   0.2145848
3      875465       845446 0.9705765    0.9845400 0.9578793   0.7403110
       live      Dump+     Dump-    Tcells        Vd2+      Vd2-     Va7.2+
1 0.9020581 0.21090996 0.6911482 0.2804264 0.008120361 0.9918796 0.01448070
2 0.8908981 0.06252775 0.8283703 0.6748298 0.007265620 0.9927344 0.01577499
3 0.8757665 0.20023803 0.6755285 0.6119129 0.004651313 0.9953487 0.01579402
     Va7.2-      CD4+      CD4-      CD8+       CD8- Tcells_count
1 0.9773989 0.6341164 0.3432825 0.2734826 0.06979990       164771
2 0.9769594 0.6119112 0.3650482 0.3357696 0.02927858       208241
3 0.9795547 0.6639621 0.3155925 0.2862104 0.02938209       371723
  lymphocytes_count  Monocytes     Debris CD45_count
1            587573 0.11796509 0.13723513     915203
2            308583 0.09477437 0.13973396    1438047
3            607477 0.01545999 0.04212072     820570</code></pre>
</div>
</div>
</section>
<section id="mutate" class="level2">
<h2 class="anchored" data-anchor-id="mutate">mutate</h2>
<p>As we can see, with just these handful of functions, we have the building blocks to rearrange and subset a larger data.frame into a format that we prefer. But what if we wanted to alter the content of a column, or add new columns to an existing data.frame? This is where the <code>mutate()</code> function can be used.</p>
<p>Let’s start by slimming down our current Data to a smaller workable example, highlighting the functions and pipes we learned about today</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>TidyData <span class="ot">&lt;-</span> Data <span class="sc">|&gt;</span> <span class="fu">filter</span>(Condition <span class="sc">%in%</span> <span class="st">"Ctrl"</span>) <span class="sc">|&gt;</span> <span class="fu">filter</span>(timepoint <span class="sc">%in%</span> <span class="st">"0"</span>) <span class="sc">|&gt;</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>     <span class="fu">select</span>(bid, timepoint, Condition, Date, Tcells_count, CD45_count) <span class="sc">|&gt;</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rename</span>(<span class="at">specimen=</span>bid, <span class="at">condition=</span>Condition) <span class="sc">|&gt;</span> <span class="fu">relocate</span>(Date, <span class="at">.after=</span>specimen)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>TidyData</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   specimen       Date timepoint condition Tcells_count CD45_count
1   INF0052 2025-07-26         0      Ctrl       164771     915203
2   INF0100 2025-07-26         0      Ctrl       208241    1438047
3   INF0179 2025-07-26         0      Ctrl       291777     940733
4   INF0134 2025-07-29         0      Ctrl       127866     689676
5   INF0148 2025-07-29         0      Ctrl       234335    1013985
6   INF0191 2025-07-29         0      Ctrl        55780     715443
7   INF0124 2025-07-31         0      Ctrl        70297     687720
8   INF0149 2025-07-31         0      Ctrl       107900     857845
9   INF0169 2025-07-31         0      Ctrl        75540     854594
10  INF0019 2025-08-05         0      Ctrl       208055     873622
11  INF0032 2025-08-05         0      Ctrl       361034     753064
12  INF0180 2025-08-05         0      Ctrl       284958    1049663
13  INF0155 2025-08-07         0      Ctrl       281626    1065048
14  INF0158 2025-08-07         0      Ctrl       280913    1249338
15  INF0159 2025-08-07         0      Ctrl       452551    1190219
16  INF0013 2025-08-22         0      Ctrl       182751     836573
17  INF0023 2025-08-22         0      Ctrl       218435     968035
18  INF0030 2025-08-22         0      Ctrl        85521     732321
19  INF0166 2025-08-28         0      Ctrl       225650     739495
20  INF0199 2025-08-28         0      Ctrl       169736    1112176
21  INF0207 2025-08-28         0      Ctrl        39055     905365
22  INF0614 2025-08-30         0      Ctrl       224396    1569007
23  INF0622 2025-08-30         0      Ctrl       161924     939307</code></pre>
</div>
</div>
<p>The <code>mutate()</code> function can be used to modify existing columns, as well as to create new ones. For example, let’s derrive the proportion of T cells from the overall CD45 gate. To do so, within the parenthesis, we would specify a new column name, and then divide the original columns:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>TidyData <span class="ot">&lt;-</span> TidyData <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">Tcells_ProportionCD45 =</span> Tcells_count <span class="sc">/</span> CD45_count)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>TidyData</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   specimen       Date timepoint condition Tcells_count CD45_count
1   INF0052 2025-07-26         0      Ctrl       164771     915203
2   INF0100 2025-07-26         0      Ctrl       208241    1438047
3   INF0179 2025-07-26         0      Ctrl       291777     940733
4   INF0134 2025-07-29         0      Ctrl       127866     689676
5   INF0148 2025-07-29         0      Ctrl       234335    1013985
6   INF0191 2025-07-29         0      Ctrl        55780     715443
7   INF0124 2025-07-31         0      Ctrl        70297     687720
8   INF0149 2025-07-31         0      Ctrl       107900     857845
9   INF0169 2025-07-31         0      Ctrl        75540     854594
10  INF0019 2025-08-05         0      Ctrl       208055     873622
11  INF0032 2025-08-05         0      Ctrl       361034     753064
12  INF0180 2025-08-05         0      Ctrl       284958    1049663
13  INF0155 2025-08-07         0      Ctrl       281626    1065048
14  INF0158 2025-08-07         0      Ctrl       280913    1249338
15  INF0159 2025-08-07         0      Ctrl       452551    1190219
16  INF0013 2025-08-22         0      Ctrl       182751     836573
17  INF0023 2025-08-22         0      Ctrl       218435     968035
18  INF0030 2025-08-22         0      Ctrl        85521     732321
19  INF0166 2025-08-28         0      Ctrl       225650     739495
20  INF0199 2025-08-28         0      Ctrl       169736    1112176
21  INF0207 2025-08-28         0      Ctrl        39055     905365
22  INF0614 2025-08-30         0      Ctrl       224396    1569007
23  INF0622 2025-08-30         0      Ctrl       161924     939307
   Tcells_ProportionCD45
1             0.18003765
2             0.14480820
3             0.31015921
4             0.18540010
5             0.23110302
6             0.07796568
7             0.10221747
8             0.12578030
9             0.08839285
10            0.23815220
11            0.47942008
12            0.27147570
13            0.26442564
14            0.22484948
15            0.38022498
16            0.21845195
17            0.22564783
18            0.11678076
19            0.30514067
20            0.15261613
21            0.04313730
22            0.14301785
23            0.17238666</code></pre>
</div>
</div>
<p>We can see that we have many significant digits being returned. Let’s round this new column to 2 significant digits by applying the <code>round()</code> function</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>TidyData <span class="ot">&lt;-</span> TidyData <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">TcellsRounded =</span> <span class="fu">round</span>(Tcells_ProportionCD45, <span class="dv">2</span>))</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>TidyData </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   specimen       Date timepoint condition Tcells_count CD45_count
1   INF0052 2025-07-26         0      Ctrl       164771     915203
2   INF0100 2025-07-26         0      Ctrl       208241    1438047
3   INF0179 2025-07-26         0      Ctrl       291777     940733
4   INF0134 2025-07-29         0      Ctrl       127866     689676
5   INF0148 2025-07-29         0      Ctrl       234335    1013985
6   INF0191 2025-07-29         0      Ctrl        55780     715443
7   INF0124 2025-07-31         0      Ctrl        70297     687720
8   INF0149 2025-07-31         0      Ctrl       107900     857845
9   INF0169 2025-07-31         0      Ctrl        75540     854594
10  INF0019 2025-08-05         0      Ctrl       208055     873622
11  INF0032 2025-08-05         0      Ctrl       361034     753064
12  INF0180 2025-08-05         0      Ctrl       284958    1049663
13  INF0155 2025-08-07         0      Ctrl       281626    1065048
14  INF0158 2025-08-07         0      Ctrl       280913    1249338
15  INF0159 2025-08-07         0      Ctrl       452551    1190219
16  INF0013 2025-08-22         0      Ctrl       182751     836573
17  INF0023 2025-08-22         0      Ctrl       218435     968035
18  INF0030 2025-08-22         0      Ctrl        85521     732321
19  INF0166 2025-08-28         0      Ctrl       225650     739495
20  INF0199 2025-08-28         0      Ctrl       169736    1112176
21  INF0207 2025-08-28         0      Ctrl        39055     905365
22  INF0614 2025-08-30         0      Ctrl       224396    1569007
23  INF0622 2025-08-30         0      Ctrl       161924     939307
   Tcells_ProportionCD45 TcellsRounded
1             0.18003765          0.18
2             0.14480820          0.14
3             0.31015921          0.31
4             0.18540010          0.19
5             0.23110302          0.23
6             0.07796568          0.08
7             0.10221747          0.10
8             0.12578030          0.13
9             0.08839285          0.09
10            0.23815220          0.24
11            0.47942008          0.48
12            0.27147570          0.27
13            0.26442564          0.26
14            0.22484948          0.22
15            0.38022498          0.38
16            0.21845195          0.22
17            0.22564783          0.23
18            0.11678076          0.12
19            0.30514067          0.31
20            0.15261613          0.15
21            0.04313730          0.04
22            0.14301785          0.14
23            0.17238666          0.17</code></pre>
</div>
</div>
</section>
<section id="arrange" class="level2">
<h2 class="anchored" data-anchor-id="arrange">arrange</h2>
<p>And while we are here, let’s rearrange the rows so that they are descending based on the Tcell proportion. We can use this by using the <code>desc()</code> and <code>arrange()</code> functions from <code>dplyr</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>TidyData <span class="ot">&lt;-</span> TidyData <span class="sc">|&gt;</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(TcellsRounded))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And let’s go ahead and <code>filter()</code> and identify the specimens that had more than 30% T cells as part of the overall CD45 gate (context, these samples were Cord Blood):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>TidyData <span class="sc">|&gt;</span> <span class="fu">filter</span>(TcellsRounded <span class="sc">&gt;</span> <span class="fl">0.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  specimen       Date timepoint condition Tcells_count CD45_count
1  INF0032 2025-08-05         0      Ctrl       361034     753064
2  INF0159 2025-08-07         0      Ctrl       452551    1190219
3  INF0179 2025-07-26         0      Ctrl       291777     940733
4  INF0166 2025-08-28         0      Ctrl       225650     739495
  Tcells_ProportionCD45 TcellsRounded
1             0.4794201          0.48
2             0.3802250          0.38
3             0.3101592          0.31
4             0.3051407          0.31</code></pre>
</div>
</div>
<p>Which is we had wanted to just retrieve the specimen IDs, we could add <code>pull()</code> after a new pipe argument.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>TidyData <span class="sc">|&gt;</span> <span class="fu">filter</span>(TcellsRounded <span class="sc">&gt;</span> <span class="fl">0.3</span>) <span class="sc">|&gt;</span> <span class="fu">pull</span>(specimen)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "INF0032" "INF0159" "INF0179" "INF0166"</code></pre>
</div>
</div>
<p>And finally, since I may want to send the data to a supervisor, let’s go ahead and export this “tidyed” version of our data.frame out to it’s own .fcs file. Working within our project folder, this would look like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>NewName <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"MyNewDataset"</span>, <span class="st">".csv"</span>)</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>StorageLocation <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">"data"</span>, NewName)</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>StorageLocation</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "data/MyNewDataset.csv"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(TidyData, StorageLocation, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="take-away" class="level1">
<h1>Take Away</h1>
<p>In this session, we explored the main functions within the <code>dplyr</code> package used in context of “tidying” data, including selecting columns, filtering for rows, as well as additional functions used to create or modify existing values. We will continue to build on these throughout the course, introducing a few additional tidyverse functions we don’t have time to cover today as appropiate. As we saw, knowing how to use these functions can allow us to extensively and quickly modify our existing exported data files.</p>
<p>On important goal as we move through the course (in terms of both reproducibility and replicability) is to attempt to only modify files within R, not go back to the original csv or excel file and hand-modify individual values. This approach is not reproducible or replicable. Once set up, an R script can quickly re-carry out these same cleanup steps, and leave a documented process of how the data has changed (even more so if you are maintaining version control). If you do want to save the changes you have made, it is best to save it out as a new .csv file with which you work later.</p>
<p>Next week, we will be using these skills when setting up metadata for our .fcs files. We will additionally take a look at the main format source of controversy within Bioconductor Flow Cytometry packages, ie. whether to use a flowframe or a cytoframe. Exciting stuff, but important information to know as the functions needed to import them are slightly different. We will also look at how to import existing manually gated .wsp from FlowJo/Diva/Floreada in via the <code>CytoML</code> package.</p>
<p><img src="images/TakeAway.jpg" class="img-fluid"></p>
</section>
<section id="additional-resources" class="level1">
<h1>Additional Resources</h1>
<p><a href="https://datacarpentry.github.io/spreadsheet-ecology-lesson/">Data Organization in Spreadsheets for Ecologists</a> This Carpentry self-study course was one of my “Aha” moments early on when learning R, and reinforced the need to try to keep my own Excel/CSV files in a tidy manner. It is worth the time going through in its entirety (even for non-Ecologist).</p>
<p><a href="https://datacarpentry.github.io/R-ecology-lesson/">Data Analysis and Visualization in R for Ecologists</a> Continuation of the above, and a good way to continue building on the tidyverse functions we learned today.</p>
<p><a href="https://youtu.be/Bg4qxVNaDck?si=QPQq8TzOZ1w6XSy4">Simplistics: Introduction to Tidyverse in R</a> The YouTube channel is mainly focused on statistics for Psych classes, but at the end of the day, we are all working with similar objects with rows and columns, just the values contained within differ.</p>
<p><a href="https://youtube.com/playlist?list=PLmNrK_nkqBpKf7j_ewpUm-w33R6PJYtD9&amp;si=BVmDZPIXjRuHjERP">Riffomonas Project Playlist: Data Manipulation with R’s Tidyverse</a> Riffomonas has a playlist that delves into both the tidyverse functions we used today, as well as other ones we will encounter later on in the course.</p>
</section>
<section id="take-home-problems" class="level1">
<h1>Take-home Problems</h1>
<div class="callout callout-style-default callout-tip callout-titled" title="Problem 1">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Problem 1
</div>
</div>
<div class="callout-body-container callout-body">
<p>Taking a dataset (either todays or one of your own), work through the column-operating functions (<code>select()</code>, <code>rename()</code>, and <code>relocate()</code>). Once this is done, <code>filter()</code> by conditions from two separate columns, arrange in an order that makes sense, and export this “tidy” data as a .csv file.</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Problem 2">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Problem 2
</div>
</div>
<div class="callout-body-container callout-body">
<p>We used the <code>mutate()</code> function to create new columns, but it can also be used to modify existing ones. Various numeric columns are showing way to many significant digits. As was shown, use <code>round()</code> to round all these proportion columns, but use mutate to overwrite the existing column. Export this as it’s own .csv file.</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Problem 3">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Problem 3
</div>
</div>
<div class="callout-body-container callout-body">
<p>We can also use <code>mutate()</code> to combine columns. For our dataset, “bid”, “timepoint”, “Condition” are separate columns that originally were all part of the filename for the individual .fcs file. Try to figure out a way to combine them back together using <code>paste0()</code>, and save the new column as “filename”. Once this is done, <code>pull()</code> the contents of this column, and using try to determine whether there were any duplicates (think innovative ways of using !, <code>length()</code> and <code>unique()</code>)</p>
</div>
</div>
<div style="text-align: right;">
<p><a href="https://www.gnu.org/licenses/agpl-3.0.en.html"><img src="https://www.gnu.org/graphics/agplv3-with-text-162x68.png" class="img-fluid" alt="AGPL-3.0"></a> <a href="http://creativecommons.org/licenses/by-sa/4.0/"><img src="https://licensebuttons.net/l/by-sa/4.0/88x31.png" class="img-fluid" alt="CC BY-SA 4.0"></a></p>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../course/03_InsideFCSFile/index.html" class="pagination-link" aria-label="03 - Inside a .FCS file">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">03 - Inside a .FCS file</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../Schedule.html" class="pagination-link" aria-label="Cytometry Core">
        <span class="nav-page-text">Cytometry Core</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Made with <a href="https://quarto.org/">Quarto</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p><img src="../../images/AGPL3.png" class="img-fluid" alt="AGPL-3.0"> <img src="../../images/CCBYSA.png" class="img-fluid" alt="CC-BY-SA"></p>
</div>
  </div>
</footer>




</body></html>